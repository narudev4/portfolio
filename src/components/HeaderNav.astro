---
const isTopPage = Astro.url.pathname === "/";

const navItems = [
  { href: "#top", label: "Top" },
  { href: "#about", label: "About" },
  { href: "#skills", label: "Skills" },
  { href: "/projects", label: "Projects" },
  { href: "#contact", label: "Contact" },
];

// トップページ以外では、アンカーリンクをトップページへの絶対パスに変換
const getHref = (href: string) => {
  if (href.startsWith("#") && !isTopPage) {
    return "/" + href;
  }
  return href;
};
---

<nav class="header-nav">
  <ul class="nav-list">
    {navItems.map((item) => (
      <li>
        <a
          href={getHref(item.href)}
          class="nav-link"
          data-scroll-target={item.href.startsWith("#") && isTopPage ? item.href : undefined}
        >
          {item.label}
        </a>
      </li>
    ))}
  </ul>
</nav>

<style>
  .header-nav {
    padding: 12px 24px;
  }

  .nav-list {
    display: flex;
    gap: 24px;
    list-style: none;
    margin: 0;
    padding: 0;
  }

  .nav-link {
    text-decoration: none;
    color: var(--color-text);
    font-family: var(--font-label);
    font-size: 0.875rem;
    font-weight: 500;
    letter-spacing: 0.02em;
    transition: color 0.2s ease;
  }

  .nav-link:hover {
    color: var(--color-accent);
  }

  .nav-link:focus-visible {
    outline: 2px solid var(--color-accent);
    outline-offset: 2px;
  }
</style>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const frameScroll = document.getElementById("frame-scroll");
    const navLinks = document.querySelectorAll(".nav-link[data-scroll-target]");

    navLinks.forEach((link) => {
      link.addEventListener("click", (e) => {
        e.preventDefault();
        const targetId = link.getAttribute("data-scroll-target");
        if (!targetId || !frameScroll) return;

        const targetElement = document.querySelector(targetId);
        if (targetElement) {
          frameScroll.scrollTo({
            top: targetElement.offsetTop - frameScroll.offsetTop,
            behavior: "smooth",
          });
        }
      });
    });
  });
</script>
